%%
%% This is file `siunitx.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% siunitx.dtx  (with options: `package')
%% ---------------------------------------------------------------
%% The siunitx package --- A comprehensive (SI) units package
%% Maintained by Joseph Wright
%% E-mail: joseph.wright@morningstar2.co.uk
%% Released under the LaTeX Project Public License v1.3c or later
%% See http://www.latex-project.org/lppl.txt
%% ---------------------------------------------------------------
%% 
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{siunitx}
  [2009/03/29 v2.0alpha A comprehensive (SI) units package]
\begingroup
  \@ifundefined{eTeXversion}{%
    \PackageError{siunitx}{Not running under e-TeX}{%
       This package requires e-TeX. Try compiling the document with
       \MessageBreak `elatex' instead of `latex'. When using pdfTeX, try
       `pdfelatex' \MessageBreak instead of `pdflatex'.
     }%
     \endgroup\endinput
  }{%
    \endgroup
}
\begingroup
  \@for\@tempa:=SIunits,sistyle,siunits,SIstyle,unitsdef,fancyunits\do{%
    \@ifpackageloaded{\@tempa}{%
      \PackageError{siunitx}{Package `\@tempa' incompatible}{%
         The \@tempa\space package and siunitx are incompatible.
         \MessageBreak Use the `emulate=\@tempa' package option when
         loading siunitx.
      }%
    }{}%
  }
\endgroup
\newcommand*{\si@package@check}{%
  \begingroup
    \@for\@tempa:=SIunits,sistyle,siunits,SIstyle\do{
      \@ifpackageloaded{\@tempa}{%
        \PackageError{siunitx}{Package `\@tempa' incompatible}{%
          The \@tempa\space package and siunitx are incompatible.
          \MessageBreak Use the `emulate=\@tempa' package option when
           loading siunitx.
        }%
      }{}%
    }%
  \endgroup
}
\AtBeginDocument{\si@package@check}
\newcommand*{\si@catcode@restore}{}
\newcommand*{\si@catcode@set}{}
\newcommand*{\si@catcode@store}[2]{%
  \edef\si@catcode@restore{%
    \si@catcode@restore
    \catcode#1 \the\catcode#1\relax
  }%
  \catcode#1 #2\relax
}
\newcommand*{\si@catcode@symbols}{%
  \si@catcode@set{42}{12}% *
  \si@catcode@set{43}{12}% +
  \si@catcode@set{44}{12}% ,
  \si@catcode@set{46}{12}% .
  \si@catcode@set{47}{12}% /
  \si@catcode@set{58}{12}% :
  \si@catcode@set{59}{12}% ;
  \si@catcode@set{60}{12}% <
  \si@catcode@set{61}{12}% =
  \si@catcode@set{62}{12}% >
}
\let\si@catcode@set\si@catcode@store
\si@catcode@symbols
\si@catcode@set{38}{4}% &
\si@catcode@set{45}{12}% -
\si@catcode@set{94}{7}% ^
\si@catcode@set{95}{8}% _
\si@catcode@set{126}{13}% ~
\renewcommand*{\si@catcode@set}[2]{%
  \catcode#1 #2\relax
}
\newcommand*{\si@lccode@restore}{}
\edef\si@lccode@restore{%
  \lccode38 \the\lccode38\relax % &
}
\newcommand*{\si@lccode@set}[2]{%
  \lccode#1 #2\relax
}
\RequirePackage{amstext,array,etex,pgfkeys}
\newcommand*{\si@encoding@ts@one}{%
  \@ifundefined{T@TS1}{%
    \DeclareFontEncoding{TS1}{}{}%
    \DeclareFontSubstitution{TS1}{cmr}{m}{n}%
  }{}%
}
\AtBeginDocument{%
  \si@encoding@ts@one
}
\newcommand*{\si@key@path}{}
\newcommand*{\si@key@error}{%
  \expandafter\si@key@error@aux\pgfkeyscurrentkey\si@stop
}
\newcommand*{\si@key@error@aux}{}
\def\si@key@error@aux/siunitx/#1\si@stop{%
  \si@log@error{Unknown option `#1'}{%
    The option `#1' is not known to siunitx.
  }%
}
\newcommand*{\si@keys@family}[1]{%
  \pgfkeys{
    /siunitx/#1/.is family,
    /siunitx/#1/.unknown/.code = \si@key@error
  }%
}
\pgfkeys{
  /siunitx/.is family,
  /siunitx/.unknown/.code = \si@key@error
}
\pgfkeys{
  /handlers/.is siunitx switch/.code = {%
    \edef\si@key@path{\pgfkeyscurrentpath}%
    \pgfkeys{
      \si@key@path/.is choice,
      \si@key@path/.default    = {true},
      \si@key@path/true/.code  = {\si@bool@cs@true{si@#1@bool}},
      \si@key@path/false/.code = {\si@bool@cs@false{si@#1@bool}},
      \si@key@path/yes/.code   = {\si@bool@cs@true{si@#1@bool}},
      \si@key@path/no/.code    = {\si@bool@cs@false{si@#1@bool}},
      \si@key@path/on/.code    = {\si@bool@cs@true{si@#1@bool}},
      \si@key@path/off/.code   = {\si@bool@cs@false{si@#1@bool}},
    }%
  }
}
\newcommand*{\si@false@bool}{01}
\newcommand*{\si@true@bool}{00}
\newcommand*{\si@tmp@bool}{}
\newcommand*{\si@tempa}{}
\newcommand*{\si@tempb}{}
\newcount\si@tempcnt
\newsavebox\si@tempbox
\newtoks\si@temp@toks
\newcommand*{\si@log@error}{%
  \PackageError{siunitx}%
}
\newcommand*{\si@log@info}{%
  \PackageInfo{siunitx}%
}
\newcommand*{\si@log@warning}{%
  \PackageWarning{siunitx}%
}
\newcommand*{\si@reserveda}{}
\newcommand*{\si@reservedb}{}
\newtoks\si@reserved@toks
\newcommand*{\si@add@left@n}[2]{%
  \def\si@reserveda{#2}%
  \edef#1{%
    \expandafter\unexpanded\expandafter{\si@reserveda}%
    \expandafter\unexpanded\expandafter{#1}%
  }%
}
\newcommand*{\si@add@left@o}[2]{%
  \expandafter\si@add@left@n\expandafter#1\expandafter{#2}%
}
\newcommand*{\si@add@left@cs@n}[1]{%
  \expandafter\si@add@left@n\csname #1\endcsname
}
\newcommand*{\si@add@left@cs@o}[1]{%
  \expandafter\si@add@left@o\csname #1\endcsname
}
\newcommand*{\si@add@right@n}[2]{%
  \def\si@reserveda{#2}%
  \edef#1{%
    \expandafter\unexpanded\expandafter{#1}%
    \expandafter\unexpanded\expandafter{\si@reserveda}%
  }%
}
\newcommand*{\si@add@right@o}[2]{%
  \expandafter\si@add@right@n\expandafter#1\expandafter{#2}%
}
\newcommand*{\si@add@right@cs@n}[1]{%
  \expandafter\si@add@right@n\csname #1\endcsname
}
\newcommand*{\si@add@right@cs@o}[1]{%
  \expandafter\si@add@right@o\csname #1\endcsname
}
\newcommand*{\si@bool@false}[1]{%
  \let#1\si@false@bool
}
\newcommand*{\si@bool@new}[1]{%
  \newcommand*{#1}{}%
  \let#1\si@false@bool
}
\newcommand*{\si@bool@true}[1]{%
  \let#1\si@true@bool
}
\newcommand*{\si@bool@cs@false}[1]{%
  \expandafter\si@bool@false\csname #1\endcsname
}
\newcommand*{\si@bool@cs@new}[1]{%
  \expandafter\si@bool@new\csname #1\endcsname
}
\newcommand*{\si@bool@cs@true}[1]{%
  \expandafter\si@bool@true\csname #1\endcsname
}
\newcommand*{\si@bool@if@F}[1]{%
  \if#1%
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@bool@if@T}[1]{%
  \if#1%
    \expandafter\@firstofone
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@bool@if@TF}[1]{%
  \if#1%
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@bool@cs@if@F}[1]{%
  \expandafter\si@bool@if@F\csname #1\endcsname
}
\newcommand*{\si@bool@cs@if@T}[1]{%
  \expandafter\si@bool@if@T\csname #1\endcsname
}
\newcommand*{\si@bool@cs@if@TF}[1]{%
  \expandafter\si@bool@if@TF\csname #1\endcsname
}
\newcommand*{\si@clear@cs}[1]{%
  \si@let@cN{#1}\@empty
}
\newcommand*{\si@clear@macro}[1]{%
  \let#1\@empty
}
\newcommand*{\si@count@incr@cs}[1]{%
  \advance\@nameuse{#1}\@ne\relax
}
\newcommand*{\si@csname@if@F}[1]{%
  \ifcsname #1\endcsname
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@csname@if@T}[1]{%
  \ifcsname #1\endcsname
    \expandafter\@firstofone
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@csname@if@TF}[1]{%
  \ifcsname #1\endcsname
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@dowhile@bool@T}[2]{%
  #2%
  \si@bool@if@T#1{%
    \si@dowhile@bool@T#1{#2}%
  }%
}
\newcommand*{\si@empty@cs@if@F}[1]{%
  \expandafter\si@empty@if@F\csname #1\endcsname
}
\newcommand*{\si@empty@cs@if@T}[1]{%
  \expandafter\si@empty@if@T\csname #1\endcsname
}
\newcommand*{\si@empty@cs@if@TF}[1]{%
  \expandafter\si@empty@if@TF\csname #1\endcsname
}
\newcommand*{\si@empty@if@F}[1]{%
  \si@meaning@eq@if@F#1\@empty
}
\newcommand*{\si@empty@if@T}[1]{%
  \si@meaning@eq@if@T#1\@empty
}
\newcommand*{\si@empty@if@TF}[1]{%
  \si@meaning@eq@if@TF#1\@empty
}
\newcommand*{\si@empty@tlist@if@F}[1]{%
  \expandafter\ifx\expandafter\si@nil\detokenize{#1}\si@nil
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@empty@tlist@if@T}[1]{%
  \expandafter\ifx\expandafter\si@nil\detokenize{#1}\si@nil
    \expandafter\@firstofone
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@empty@tlist@if@TF}[1]{%
  \expandafter\ifx\expandafter\si@nil\detokenize{#1}\si@nil
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@empty@toks@if@F}[1]{%
 \expandafter\si@empty@tlist@if@F\expandafter{\the#1}%
}
\newcommand*{\si@empty@toks@if@T}[1]{%
 \expandafter\si@empty@tlist@if@T\expandafter{\the#1}%
}
\newcommand*{\si@empty@toks@if@TF}[1]{%
 \expandafter\si@empty@tlist@if@TF\expandafter{\the#1}%
}
\newcommand*{\si@elt@count}[1]{%
  \number\numexpr 0\si@loop@over@macro#1\si@elt@count@aux\relax
}
\newcommand*{\si@elt@count@aux}[1]{+1}
\newcommand*{\si@elt@count@cs}[1]{%
  \expandafter\si@elt@count\csname #1\endcsname
}
\newcommand*{\si@expand@tlist}[2]{%
  \si@clear@macro#1%
  \def\si@reservedb##1{%
    \si@add@right@o#1{##1}%
  }%
  \si@loop@over@macro@aux\si@reservedb#2\si@loop@end\si@loop@stop
}
\newcommand*{\si@expand@tlist@cs}[1]{%
  \expandafter\si@expand@tlist\csname #1\endcsname
}
\newcommand*{\si@in@if@F}[2]{%
  \def\si@reserveda##1#2##2\si@stop{%
    \si@no@value@if@T{##2}%
  }%
  \expandafter\si@reserveda#1#2\si@no@value\si@stop
}
\newcommand*{\si@in@if@T}[2]{%
  \def\si@reserveda##1#2##2\si@stop{%
    \si@no@value@if@F{##2}%
  }%
  \expandafter\si@reserveda#1#2\si@no@value\si@stop
}
\newcommand*{\si@in@if@TF}[2]{%
  \def\si@reserveda##1#2##2\si@stop{%
    \si@no@value@if@FT{##2}%
  }%
  \expandafter\si@reserveda#1#2\si@no@value\si@stop
}
\newcommand*{\si@in@tlist@if@F}[2]{%
  \def\si@reserveda##1#2##2\si@stop{%
    \si@no@value@if@T{##2}%
  }%
  \si@reserveda#1#2\si@no@value\si@stop
}
\newcommand*{\si@in@tlist@if@T}[2]{%
  \def\si@reserveda##1#2##2\si@stop{%
    \si@no@value@if@F{##2}%
  }%
  \si@reserveda#1#2\si@no@value\si@stop
}
\newcommand*{\si@in@tlist@if@TF}[2]{%
  \def\si@reserveda##1#2##2\si@stop{%
    \si@no@value@if@FT{##2}%
  }%
  \si@reserveda#1#2\si@no@value\si@stop
}
\newcommand*{\si@in@cs@if@F}[1]{%
  \expandafter\si@in@if@F\csname #1\endcsname
}
\newcommand*{\si@in@cs@if@T}[1]{%
  \expandafter\si@in@if@T\csname #1\endcsname
}
\newcommand*{\si@in@cs@if@TF}[1]{%
  \expandafter\si@in@if@TF\csname #1\endcsname
}
\newcommand*{\si@let@cc}[2]{%
  \expandafter\si@let@cN\expandafter{\expandafter#1\expandafter}%
    \csname #2\endcsname
}
\newcommand*{\si@let@cN}[1]{%
  \expandafter\let\csname #1\endcsname
}
\newcommand*{\si@let@Nc}[2]{%
  \expandafter\let\expandafter#1\csname #2\endcsname
}
\newcommand*{\si@loop@over@cs}[1]{%
  \expandafter\si@loop@over@macro\csname #1\endcsname
}
\newcommand*{\si@loop@over@macro}[2]{%
  \expandafter\si@loop@over@macro@aux
  \expandafter#2#1\si@loop@end\si@loop@stop
}
\newcommand*{\si@loop@over@macro@aux}[2]{%
  \si@loop@end@if{#2}%
  #1{#2}%
  \si@loop@over@macro@aux#1%
}
\newcommand*{\si@loop@end@if}[1]{%
  \expandafter\ifx\si@loop@end@if@aux#1?\si@nil\si@loop@end\si@loop@end
    \expandafter\si@loop@exit
  \fi
}
\newcommand*{\si@loop@exec@end@if}[2]{%
  \expandafter\ifx\si@loop@end@if@aux#1?\si@nil\si@loop@end\si@loop@end
    \expandafter\si@loop@exit@exec
  \else
    \expandafter\@gobble
  \fi
  {#2}%
}
\newcommand*{\si@loop@end@if@aux}{}
\def\si@loop@end@if@aux#1#2\si@nil\si@loop@end{#1}
\newcommand*{\si@loop@exit}{}
\def\si@loop@exit#1\si@loop@stop{}
\newcommand*{\si@loop@exit@exec}{}
\def\si@loop@exit@exec#1#2\si@loop@stop{#1}
\newcommand*{\si@loop@end}{\si@loop@end}
\newcommand*{\si@loop@stop}{\si@loop@stop}
\newcommand*{\si@loop@over@three}[2]{%
  \expandafter\si@loop@over@three@aux
  \expandafter#2#1\si@loop@end\si@loop@stop
}
\newcommand*{\si@loop@over@three@aux}[4]{%
  \si@loop@end@if{#2}%
  #1{#2#3#4}%
  \si@loop@over@three@aux#1%
}
\newcommand*{\si@loop@over@three@cs}[1]{%
  \expandafter\si@loop@over@three\csname #1\endcsname
}
\newcommand*{\si@meaning@eq@if@F}[2]{%
  \ifx#1#2%
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@meaning@eq@if@T}[2]{%
  \ifx#1#2%
    \expandafter\@firstofone
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@meaning@eq@if@TF}[2]{%
  \ifx#1#2%
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@meaning@eq@cs@if@F}[2]{%
  \expandafter\si@meaning@eq@if@F\csname #1\expandafter\endcsname
    \csname #2\endcsname
}
\newcommand*{\si@meaning@eq@cs@if@T}[2]{%
  \expandafter\si@meaning@eq@if@T\csname #1\expandafter\endcsname
    \csname #2\endcsname
}
\newcommand*{\si@meaning@eq@cs@if@TF}[2]{%
  \expandafter\si@meaning@eq@if@TF\csname #1\expandafter\endcsname
    \csname #2\endcsname
}
\newcommand*{\si@mode@maths@display@if@T}{%
  \ifmmode
    \ifinner
      \expandafter\expandafter\expandafter\@gobble
    \else
      \expandafter\expandafter\expandafter\@firstofone
    \fi
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@mode@maths@inline@if@T}{%
  \ifmmode
    \ifinner
      \expandafter\expandafter\expandafter\@firstofone
    \else
      \expandafter\expandafter\expandafter\@gobble
    \fi
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@mode@maths@if@F}{%
  \ifmmode
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@mode@maths@if@TF}{%
  \ifmmode
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@edef@c}[1]{%
  \expandafter\edef\csname #1\endcsname
}
\newcommand*{\si@newcommand}{%
  \@ifstar{%
    \let\l@ngrel@x\protected
    \si@newcommand@aux@i
  }{%
    \def\l@ngrel@x{\protected\long}%
    \si@newcommand@aux@i
  }%
}
\newcommand*{\si@newcommand@aux@i}[1]{%
  \@testopt{\si@newcommand@aux@ii#1}0%
}
\newcommand*{\si@newcommand@aux@ii}{}
\def\si@newcommand@aux@ii#1[#2]{%
  \@ifnextchar[{%
    \si@newcommand@aux@iii#1[#2]%
  }{%
    \@argdef#1[#2]%
  }%]
}
\newcommand*{\si@newcommand@aux@iii}{}
\def\si@newcommand@aux@iii#1[#2][#3]#4{%
  \@ifdefinable#1{%
    \expandafter\protected\expandafter\def\expandafter#1\expandafter{%
      \expandafter\@testopt\csname\string#1\endcsname{#3}%
    }%
    \expandafter\@yargdef\csname\string#1\endcsname\tw@{#2}{#4}%
  }%
}
\newcommand*{\si@nil}{\si@nil}
\newcommand*{\si@stop}{\si@stop}
\newcommand*{\si@no@value}{\si@no@value}
\newcommand*{\si@no@value@if@F}[1]{%
  \if\si@no@value@if@aux@i{#1}%
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@no@value@if@FT}[1]{%
  \if\si@no@value@if@aux@i{#1}%
    \expandafter\@secondoftwo
  \else
    \expandafter\@firstoftwo
  \fi
}
\newcommand*{\si@no@value@if@T}[1]{%
  \if\si@no@value@if@aux@i{#1}%
    \expandafter\@firstofone
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@no@value@if@TF}[1]{%
  \if\si@no@value@if@aux@i{#1}%
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@no@value@if@aux@i}[1]{%
  \if\expandafter\si@no@value@if@aux@ii\expandafter
    {\string\si@no@value\space}{\detokenize{#1}}%
    \si@true@bool
  \else
    \si@false@bool
  \fi
}
\newcommand*{\si@no@value@if@aux@ii}[1]{%
  \if\number\si@no@value@if@aux@iii{}{}#1\relax
}
\newcommand*{\si@no@value@if@aux@iii}[3]{%
  \if#3\relax
    \expandafter\si@no@value@if@aux@iv
  \fi
  \si@no@value@if@aux@iii{\if#3#1}{#2\fi}%
}
\newcommand*{\si@no@value@if@aux@iv}{}
\def\si@no@value@if@aux@iv\si@no@value@if@aux@iii#1#2#3{%
  #1#3\relax'#213
    \si@true@bool
  \else
    \si@false@bool
  \fi
}
\newcommand*{\si@num@if@F}[1]{%
  \ifnum#1\relax
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
}
\newcommand*{\si@num@if@T}[1]{%
  \ifnum#1\relax
    \expandafter\@firstofone
  \else
    \expandafter\@gobble
  \fi
}
\newcommand*{\si@num@if@TF}[1]{%
  \ifnum#1\relax
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}
\newcommand*{\si@replace@all@in}[3]{%
  \si@reserved@toks{}%
  \def\si@tempa##1#2##2\si@stop{%
    \si@no@value@if@TF{##2}{%
      \si@replace@all@in@aux{##1}%
    }{%
      \si@replace@all@in@aux{##1#3}%
      \si@tempa\@empty##2\si@stop
    }%
  }%
  \@firstofone{\expandafter\si@tempa\expandafter\@empty}%
  #1#2\si@no@value\si@stop
  \edef#1{\the\si@reserved@toks}%
}
\newcommand*{\si@replace@all@in@aux}[1]{%
  \si@reserved@toks\expandafter\expandafter\expandafter{%
    \expandafter\the\expandafter\si@reserved@toks#1%
  }%
}
\newcommand*{\si@replace@all@in@cs}[1]{%
  \expandafter\si@replace@all@in\csname #1\endcsname
}
\newcommand*{\si@reverse@macro}[1]{%
 \edef#1{%
   \expandafter\si@reverse@tlist\expandafter{#1}%
  }%
}
\newcommand*{\si@reverse@cs}[1]{%
 \expandafter\si@reverse@macro\csname #1\endcsname
}
\newcommand*{\si@reverse@tlist}[1]{%
  \si@reverse@tlist@aux{}#1\si@loop@end\si@loop@stop
}
\newcommand*{\si@reverse@tlist@aux}[2]{%
  \si@loop@exec@end@if{#2}{#1}%
  \si@reverse@tlist@aux{#2#1}%
}
\newcommand*{\si@stop@if@F}[1]{%
  \si@meaning@eq@if@F#1\si@stop
}
\newcommand*{\si@stop@if@T}[1]{%
  \si@meaning@eq@if@T#1\si@stop
}
\newcommand*{\si@stop@if@TF}[1]{%
  \si@meaning@eq@if@TF#1\si@stop
}
\newcommand*{\si@whiledo@num@T}[2]{%
  \si@num@if@T{#1}{%
    #2\si@whiledo@num@T{#1}{#2}%
  }%
}
\newcommand*{\si@whiledo@empty@F}[2]{%
  \si@empty@if@F#1{%
    #2\si@whiledo@empty@F#1{#2}%
  }%
}
\newcommand*{\si@whiledo@empty@T}[2]{%
  \si@empty@if@T#1{%
    #2\si@whiledo@empty@T#1{#2}%
  }%
}
\newcommand*{\si@whiledo@empty@cs@F}[2]{%
  \si@empty@cs@if@F{#1}{%
    #2\si@whiledo@empty@cs@F{#1}{#2}%
  }%
}
\newcommand*{\si@whiledo@empty@cs@T}[2]{%
  \si@empty@cs@if@T{#1}{%
    #2\si@whiledo@empty@cs@T{#1}{#2}%
  }%
}
\newcommand*{\si@font@fam@mathsf}{}
\newcommand*{\si@font@fam@mathtt}{}
\newcommand*{\si@font@fam@detect@maths}[1]{%
  \begingroup
    \setbox\@tempboxa\hbox{%
      \ensuremath{%
        \csname math#1\endcsname{%
          \expandafter\global\expandafter\chardef
            \csname si@font@fam@math#1\endcsname\fam\relax
        }%
      }%
    }%
  \endgroup
}
\g@addto@macro{\document}{%
  \si@font@fam@detect@maths{sf}%
  \si@font@fam@detect@maths{tt}%
}
\newcommand*{\si@font@fam@sfdefault}{}
\newcommand*{\si@font@fam@ttfamily}{}
\newcommand*{\si@font@fam@detect@text}[1]{%
  \si@edef@c{si@font@fam@#1default}{\@nameuse{#1default}}%
}
\AtBeginDocument{%
  \si@font@fam@detect@text{sf}%
  \si@font@fam@detect@text{tt}%
}
\si@bool@new\si@font@det@b@bool
\si@bool@new\si@font@det@family@bool
\si@bool@new\si@font@det@maths@display@bool
\si@bool@new\si@font@det@maths@inline@bool
\si@bool@new\si@font@det@it@bool
\si@bool@new\si@font@det@mode@bool
\si@keys@family{font/detect}
\pgfkeys{
  /siunitx/font/detect,
  all/.style   =  {
    /siunitx/font/detect/bold   = true,
    /siunitx/font/detect/family = true,
    /siunitx/font/detect/italic = true,
    /siunitx/font/detect/mode   = true
  },
  bold/.is siunitx switch          = {font@det@b},
  display math/.is siunitx switch  = {font@det@maths@display},
  display maths/.is siunitx switch = {font@det@maths@display},
  family/.is siunitx switch        = {font@det@family},
  inline bold/.is choice,
  inline bold/.cd,
    maths/.code = {\si@bool@true\si@font@det@maths@inline@bool},
    math/.code  = {\si@bool@true\si@font@det@maths@inline@bool},
    text/.code  = {\si@bool@false\si@font@det@maths@inline@bool},
  /siunitx/font/detect,
  italic/.is siunitx switch = {font@det@it},
  mode/.is siunitx switch   = {font@det@mode},
  none/.style   =  {
    /siunitx/font/detect/bold   = false,
    /siunitx/font/detect/family = false,
    /siunitx/font/detect/italic = false,
    /siunitx/font/detect/mode   = false
  },
  bold          = false,
  display maths = true,
  inline bold   = text,
  italic        = false,
  mode          = false
}
\si@bool@new\si@font@set@bool
\newcommand*{\si@font@set@bold}{}
\newcommand*{\si@font@set@family}{}
\newcommand*{\si@font@set@italic}{}
\si@bool@new\si@font@set@text@bool
\newcommand*{\si@font@det@set}{%
  \si@bool@if@F\si@font@set@bool{%
    \si@font@det@init
    \si@bool@if@T\si@font@det@b@bool{%
      \si@font@det@bold
    }%
    \si@bool@if@T\si@font@det@family@bool{%
      \si@font@det@family
    }%
    \si@bool@if@T\si@font@det@it@bool{%
      \si@font@det@italic
    }%
    \si@bool@if@T\si@font@det@mode@bool{%
      \si@font@det@mode
    }%
  }%
}
\newcommand*{\si@font@det@init}{%
  \si@bool@true\si@font@set@bool
  \def\si@font@set@bold{\unboldmath\mdseries}%
  \def\si@font@set@family{rm}%
  \si@bool@false\si@font@set@text@bool
  \def\si@font@set@italic{\upshape}%
}
\newcommand*{\si@font@det@bold}{%
  \si@mode@maths@display@if@T{%
    \si@bool@if@TF\si@font@det@maths@display@bool{%
      \si@font@det@bold@maths
    }{%
      \si@font@det@bold@text
    }%
  }%
  \si@mode@maths@inline@if@T{%
    \si@bool@if@TF\si@font@det@maths@inline@bool{%
      \si@font@det@bold@maths
    }{%
      \si@font@det@bold@text
    }%
  }%
  \si@mode@maths@if@F{%
    \si@font@det@bold@text
  }%
}
\newcommand*{\si@font@det@bold@maths}{%
  \def\si@tempa{bold}%
  \si@meaning@eq@if@T\si@tempa\math@version{%
    \def\si@font@set@bold{\boldmath\bfseries}%
  }%
}
\newcommand*{\si@font@det@bold@text}{%
  \def\si@tempa{b}%
  \edef\si@tempb{\expandafter\@car\f@series\@nil}%
  \si@meaning@eq@if@T\si@tempa\si@tempb{%
    \def\si@font@set@bold{\boldmath\bfseries}%
  }%
}
\newcommand*{\si@font@det@family}{%
  \si@font@det@fam@text
  \si@bool@if@T\si@font@det@maths@display@bool{%
    \si@mode@maths@display@if@T{%
      \si@font@det@fam@maths
    }%
  }%
}
\newcommand*{\si@font@det@fam@maths}{%
  \def\si@font@set@family{rm}%
  \si@num@if@TF{\the\fam=\si@font@fam@mathsf}{%
    \def\si@font@set@family{sf}%
  }{%
    \si@num@if@T{\the\fam=\si@font@fam@mathtt}{%
      \def\si@font@set@family{tt}%
    }%
  }%
}
\newcommand*{\si@font@det@fam@text}{%
  \si@meaning@eq@if@T\f@family\si@font@fam@sfdefault{%
    \def\si@font@set@family{sf}%
  }%
  \si@meaning@eq@if@T\f@family\si@font@fam@ttdefault{%
    \def\si@font@set@family{tt}%
  }%
}
\newcommand*{\si@font@det@italic}{%
  \def\si@tempa{it}%
  \si@meaning@eq@if@T\si@tempa\f@shape{%
    \def\si@font@set@italic{\itshape}%
  }%
}
\newcommand*{\si@font@det@mode}{%
  \si@mode@maths@if@F{%
    \si@bool@true\si@font@set@text@bool
  }%
}
\newcommand*{\si@font@unit@maths@rm}{}
\newcommand*{\si@font@unit@maths@sf}{}
\newcommand*{\si@font@unit@maths@tt}{}
\newcommand*{\si@font@unit@text@rm}{}
\newcommand*{\si@font@unit@text@sf}{}
\newcommand*{\si@font@unit@text@tt}{}
\newcommand*{\si@font@num@maths@rm}{}
\newcommand*{\si@font@num@maths@sf}{}
\newcommand*{\si@font@num@maths@tt}{}
\newcommand*{\si@font@num@text@rm}{}
\newcommand*{\si@font@num@text@sf}{}
\newcommand*{\si@font@num@text@tt}{}
\si@bool@new\si@font@unit@textmode@bool
\si@bool@new\si@font@num@textmode@bool
\si@keys@family{font}
\si@keys@family{font/units}
\si@keys@family{font/numbers}
\pgfkeys{
  /siunitx/font,
  maths rm/.style = {
    /siunitx/font/units/maths rm = #1,
    /siunitx/font/numbers/maths rm = #1
  },
  maths sf/.style = {
    /siunitx/font/units/maths sf = #1,
    /siunitx/font/numbers/maths sf = #1
  },
  maths tt/.style = {
    /siunitx/font/units/maths tt = #1,
    /siunitx/font/numbers/maths tt = #1
  },
  maths rm/.style = {
    /siunitx/font/units/maths rm = #1,
    /siunitx/font/numbers/maths rm = #1
  },
  maths sf/.style = {
    /siunitx/font/units/maths sf = #1,
    /siunitx/font/numbers/maths sf = #1
  },
  maths tt/.style = {
    /siunitx/font/units/maths tt = #1,
    /siunitx/font/numbers/maths tt = #1
  },
  mode/.is choice,
  mode/.cd,
    maths/.style = {
      /siunitx/font/units/mode = maths,
      /siunitx/font/numbers/mode = maths
    },
    math/.style  = {
      /siunitx/font/units/mode = maths,
      /siunitx/font/numbers/mode = maths
    },
    text/.style  = {
      /siunitx/font/units/mode = text,
      /siunitx/font/numbers/mode = text
    },
  /siunitx/font,
  text rm/.style  = {